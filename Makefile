NAME			=	malware
FLAGS			=	-Wall -Wextra -Werror
USER			=	$(shell whoami)
SLEEP_TIME		=	0.025
CC				=	gcc $(FLAGS)

ifneq ($(DEBUG),)
	FLAGS += -DDEBUG=$(DEBUG)
endif

# Colors
RED				=	\033[0;31m
GREEN			=	\033[0;32m
YELLOW			=	\033[0;33m
BLUE			=	\033[0;34m
PURPLE			=	\033[0;35m
CYAN			=	\033[0;36m
WHITE			=	\033[0;37m
RESET			=	\033[0m

# Files
SOURCES			=	src/main.c src/debug.c src/encryption.c src/errors.c src/files.c src/key.c
HEADERS			=	includes/malware.h

# Functions
define minecraft
	tput civis; \
	echo "$(BLUE)⏳ $1:$(RESET) $2"; \
	sleep $(SLEEP_TIME); \
	tput cuu1; \
	tput el; \
	tput cnorm
endef

# Rules
all				:	$(NAME)

$(NAME)			:	$(SOURCES)
					@for i in $(HEADERS); do \
						$(call minecraft,INCLUDING,$$i); \
					done
					@for i in $(SOURCES); do \
						$(call minecraft,COMPILING,$$i); \
					done
					@$(CC) $(SOURCES) -o $(NAME)
					@sleep $(SLEEP_TIME)
					@echo "✅ CREATING: $(NAME)";

clean			:
					@for i in $(SOURCES:.c=.o); do \
						if [ -e $$i ]; then \
							sleep $(SLEEP_TIME); \
							echo "❌ DELETING: $$i"; \
							rm -f $$i; \
						fi \
					done

fclean			:	clean
					@rm -f $(NAME)
					@echo "❌ DELETING: $(NAME)"

re				:	fclean all

.PHONY			:	all clean fclean re